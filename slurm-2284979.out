Lmod has detected the following error: These module(s) or extension(s) exist
but cannot be loaded as requested: "Python/3.11.3-GCCcore-12.3.0"
   Try: "module spider Python/3.11.3-GCCcore-12.3.0" to see how to load the
module(s).



Python 3.6.8
Wed Apr  3 19:05:40 2024       
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 470.103.01   Driver Version: 470.103.01   CUDA Version: 11.4     |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|                               |                      |               MIG M. |
|===============================+======================+======================|
|   0  NVIDIA A100-SXM...  On   | 00000000:BD:00.0 Off |                    0 |
| N/A   36C    P0    64W / 400W |      0MiB / 81251MiB |      0%      Default |
|                               |                      |             Disabled |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                                  |
|  GPU   GI   CI        PID   Type   Process name                  GPU Memory |
|        ID   ID                                                   Usage      |
|=============================================================================|
|  No running processes found                                                 |
+-----------------------------------------------------------------------------+
Requirement already satisfied: immutabledict in ./env/lib/python3.6/site-packages (from -r requirements.txt (line 1)) (2.2.1)
Requirement already satisfied: sentencepiece in ./env/lib/python3.6/site-packages (from -r requirements.txt (line 2)) (0.2.0)
Requirement already satisfied: numpy in ./env/lib/python3.6/site-packages (from -r requirements.txt (line 3)) (1.19.5)
Requirement already satisfied: torch in ./env/lib/python3.6/site-packages (from -r requirements.txt (line 4)) (1.10.2)
Requirement already satisfied: transformers in ./env/lib/python3.6/site-packages (from -r requirements.txt (line 5)) (4.18.0)
Requirement already satisfied: dataclasses in ./env/lib/python3.6/site-packages (from torch->-r requirements.txt (line 4)) (0.8)
Requirement already satisfied: typing-extensions in ./env/lib/python3.6/site-packages (from torch->-r requirements.txt (line 4)) (4.1.1)
Requirement already satisfied: tqdm>=4.27 in ./env/lib/python3.6/site-packages (from transformers->-r requirements.txt (line 5)) (4.64.1)
Requirement already satisfied: tokenizers!=0.11.3,<0.13,>=0.11.1 in ./env/lib/python3.6/site-packages (from transformers->-r requirements.txt (line 5)) (0.12.1)
Requirement already satisfied: huggingface-hub<1.0,>=0.1.0 in ./env/lib/python3.6/site-packages (from transformers->-r requirements.txt (line 5)) (0.4.0)
Requirement already satisfied: packaging>=20.0 in ./env/lib/python3.6/site-packages (from transformers->-r requirements.txt (line 5)) (21.3)
Requirement already satisfied: requests in ./env/lib/python3.6/site-packages (from transformers->-r requirements.txt (line 5)) (2.27.1)
Requirement already satisfied: sacremoses in ./env/lib/python3.6/site-packages (from transformers->-r requirements.txt (line 5)) (0.0.53)
Requirement already satisfied: regex!=2019.12.17 in ./env/lib/python3.6/site-packages (from transformers->-r requirements.txt (line 5)) (2023.8.8)
Requirement already satisfied: filelock in ./env/lib/python3.6/site-packages (from transformers->-r requirements.txt (line 5)) (3.4.1)
Requirement already satisfied: importlib-metadata in ./env/lib/python3.6/site-packages (from transformers->-r requirements.txt (line 5)) (4.8.3)
Requirement already satisfied: pyyaml>=5.1 in ./env/lib/python3.6/site-packages (from transformers->-r requirements.txt (line 5)) (6.0.1)
Requirement already satisfied: pyparsing!=3.0.5,>=2.0.2 in ./env/lib/python3.6/site-packages (from packaging>=20.0->transformers->-r requirements.txt (line 5)) (3.1.2)
Requirement already satisfied: importlib-resources in ./env/lib/python3.6/site-packages (from tqdm>=4.27->transformers->-r requirements.txt (line 5)) (5.4.0)
Requirement already satisfied: zipp>=0.5 in ./env/lib/python3.6/site-packages (from importlib-metadata->transformers->-r requirements.txt (line 5)) (3.6.0)
Requirement already satisfied: urllib3<1.27,>=1.21.1 in ./env/lib/python3.6/site-packages (from requests->transformers->-r requirements.txt (line 5)) (1.26.18)
Requirement already satisfied: certifi>=2017.4.17 in ./env/lib/python3.6/site-packages (from requests->transformers->-r requirements.txt (line 5)) (2024.2.2)
Requirement already satisfied: idna<4,>=2.5 in ./env/lib/python3.6/site-packages (from requests->transformers->-r requirements.txt (line 5)) (3.6)
Requirement already satisfied: charset-normalizer~=2.0.0 in ./env/lib/python3.6/site-packages (from requests->transformers->-r requirements.txt (line 5)) (2.0.12)
Requirement already satisfied: six in ./env/lib/python3.6/site-packages (from sacremoses->transformers->-r requirements.txt (line 5)) (1.16.0)
Requirement already satisfied: click in ./env/lib/python3.6/site-packages (from sacremoses->transformers->-r requirements.txt (line 5)) (8.0.4)
Requirement already satisfied: joblib in ./env/lib/python3.6/site-packages (from sacremoses->transformers->-r requirements.txt (line 5)) (1.1.1)
Device:  cuda
Traceback (most recent call last):
  File "main.py", line 90, in <module>
    main()
  File "main.py", line 43, in main
    model.load_weights(ckpt_path)
  File "/home/aritram21/gemma/model.py", line 555, in load_weights
    model_path, mmap=True, weights_only=True,
  File "/home/aritram21/gemma/env/lib64/python3.6/site-packages/torch/serialization.py", line 607, in load
    return _load(opened_zipfile, map_location, pickle_module, **pickle_load_args)
  File "/home/aritram21/gemma/env/lib64/python3.6/site-packages/torch/serialization.py", line 880, in _load
    unpickler = UnpicklerWrapper(data_file, **pickle_load_args)
TypeError: 'mmap' is an invalid keyword argument for this function
